<!DOCTYPE html>
<html lang="en">
<head>
    <!-- <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'"> -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css">
    <title>EleXcel</title>
</head>
<body>
    <h1>Hello world</h1>
    <form action="http://localhost:3000/" method="post" enctype="multipart/form-data" id="myform">
        <!-- <input type="text" name="address_pt" id="" required>
        <input type="date" name="exp_date" required>
        <input type="date" name="created_at" id="" required> -->
        <input type="file" name="file_skrd" id="file_skrd" required>
        <input type="submit" value="Proses">
    </form>
    <script src="https://unpkg.com/read-excel-file@5.x/bundle/read-excel-file.min.js"></script>

    <script>
        
        var input = document.getElementById('file_skrd')
        input.addEventListener('change', function() {
            readXlsxFile(input.files[0], { sheet:1 }).then((rows) => {
                rows.forEach((e, i) => {
                    if (e[0] && !Number.isInteger(e[0])) {
                        if (e[0].substr(0, 4) == 'PT. ') {
                            console.log(e[0])
                        }
                    }
                    if (Number.isInteger(e[0])) {
                        console.log(e[3]);
                    }         
                });
            })
        })
    </script>
    <!-- <a href="http://localhost:3000/oho">klik</a> -->
    <!-- <p>
        We are using Node.js <span id="node-version"></span>,
        Chromium <span id="chrome-version"></span>,
        and Electron <span id="electron-version"></span>.
    </p> -->
    <!-- <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        const electron = require('electron');
        const ipcRenderer = electron.ipcRenderer;
        document.getElementById('myform').addEventListener("submit", function(e){
            e.preventDefault();
            // let form = document.getElementById('myform');
            // let data = new FormData(this);
            this.submit();
        },true)
    </script>
    <script>if (window.module) module = window.module;</script> -->
</body>
</html>